  # Отчёт по проделанной работе в ML-части проекта

---

В данной папке представлено решение задачи прогноза удовлетворённости клиента авиакомпании по шагам.

<img width="955" alt="Снимок экрана 2023-06-29 в 03 57 24" src="https://github.com/kamilarakhimova/customer-satisfaction-service/assets/58568615/6a52b1c8-ca9a-4968-9c10-631aa969aa33">

---

## Первым шагом проводился разведочный анализ данных (EDA).

Изначальный датасет находится в таблице [`airline_clients.csv`](https://github.com/kamilarakhimova/customer-satisfaction-service/blob/main/airline_clients.csv).

Что было проделано, кратко: удалила пропущенные и аномальные значения в некоторых столбцах (когда их количество составляло < 1%), в других столбцах либо выделяла аномальные и NaN значения в отдельную категорию, либо присваивала им среднее значение адекватных числовых значений. Категориальные столбцы с двумя значениями бинаризировала по 0 и 1. Остальные категориальные столбцы закодировала через OneHotEncoder/get_dummies. И в конце масштабировала все данные и сохранила получившиеся очищенные значения в таблицу [`airline_clients_clean.csv`](https://github.com/kamilarakhimova/customer-satisfaction-service/blob/main/airline_clients_clean.csv). В процессе просматривались графики распределения отдельных переменных, значения корреляции Пирсона между определённми столбцами, строились боксплоты, столбчатые диаграммы и гистаграммы для анализа данных.

Полное решение можно увидеть в файле [My_solution_Part_1_EDA_clients.ipynb](https://github.com/kamilarakhimova/customer-satisfaction-service/tree/main/solution/My_solution_Part_1_EDA_clients.ipynb).

---

## Вторым шагом проводилось построение  ML-модели.

Сначала взглянула на очищенный датасет, обнаружила в нём закравшийся лишний столбец и удалила. Далее было построено 2 варианта модели: первый через логистическую регрессию `Logistic Regression`, второй через алгоритм "случайного леса" `Random Forest Classifier`. Хотелось поэкспериментировать и сравнить полученные результаты. Данные были разбиты на матрицу объекты-признаки и целевую переменную, а они ещё разбиты на `train` и `test` выборки, были обучены модели, а затем проверено их качество на выбранной метрике `recall` (полнота). В итоге наилучший результат показал второй вариант, модель `Random Forest Classifier`, поэтому она и пошла в продакшен.

Полное решение можно увидеть непосредственно в файле [My_solution_Part_2_ML_clients.ipynb.ipynb](https://github.com/kamilarakhimova/customer-satisfaction-service/tree/main/solution/My_solution_Part_2_ML_clients.ipynb).

---

### Примечание

В конце модель сохранялась в файл формата ".pickle". Но она имеет большой размер (202 мб).

Вот для удобства и была создана ещё программа ["model.py"](https://github.com/kamilarakhimova/customer-satisfaction-service/blob/main/model.py) с загрузкой очищенного датасета, построением и сохранением необходимой модели `Random Forest Classifier` в проекте, то есть повторяющая наиболее существенно важные этапы из второго шага.

---

### Приятного изучения!
